<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@tapjs/snapshot - v0.0.0-18 | Node TAP</title><meta name="description" content="Documentation for Node TAP"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><link rel="stylesheet" href="../assets/custom.css"/><script defer src="../assets/main.js"></script><script async src="../assets/search.js" id="tsd-search-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os"</script><header class="tsd-page-toolbar">
<div class="tsd-toolbar-contents container">
<div class="table-cell" id="tsd-search" data-base="..">
<div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M15.7824 13.833L12.6666 10.7177C12.5259 10.5771 12.3353 10.499 12.1353 10.499H11.6259C12.4884 9.39596 13.001 8.00859 13.001 6.49937C13.001 2.90909 10.0914 0 6.50048 0C2.90959 0 0 2.90909 0 6.49937C0 10.0896 2.90959 12.9987 6.50048 12.9987C8.00996 12.9987 9.39756 12.4863 10.5008 11.6239V12.1332C10.5008 12.3332 10.5789 12.5238 10.7195 12.6644L13.8354 15.7797C14.1292 16.0734 14.6042 16.0734 14.8948 15.7797L15.7793 14.8954C16.0731 14.6017 16.0731 14.1267 15.7824 13.833ZM6.50048 10.499C4.29094 10.499 2.50018 8.71165 2.50018 6.49937C2.50018 4.29021 4.28781 2.49976 6.50048 2.49976C8.71001 2.49976 10.5008 4.28708 10.5008 6.49937C10.5008 8.70852 8.71314 10.499 6.50048 10.499Z" fill="var(--color-text)"></path></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div>
<div class="field">
<div id="tsd-toolbar-links"></div></div>
<ul class="results">
<li class="state loading">Preparing search index...</li>
<li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">Node TAP</a></div>
<div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><rect x="1" y="3" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="7" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="11" width="14" height="2" fill="var(--color-text)"></rect></svg></a></div></div></header>
<div class="container container-main">
<div class="col-content">
<div class="tsd-page-title">
<ul class="tsd-breadcrumb">
<li><a href="../index.html">Node TAP</a></li>
<li><a href="_tapjs_snapshot.html">@tapjs/snapshot</a></li></ul>
<h1>Module @tapjs/snapshot - v0.0.0-18</h1></div>
<section class="tsd-panel tsd-typography"><a id="md:tapjssnapshot" class="tsd-anchor"></a><h1><a href="#md:tapjssnapshot"><code>@tapjs/snapshot</code></a></h1><p>A default tap plugin that adds snapshot functionality.</p>
<a id="md:usage" class="tsd-anchor"></a><h2><a href="#md:usage">USAGE</a></h2><p>This plugin is installed with tap by default. If you had
previously removed it, you can <code>tap plugin add @tapjs/snapshot</code> to
bring it back.</p>
<p>Snapshots are a way to make extremely comprehensive assertions
about a value, and easily keep tests up to date. This is a
powerful technique for testing many kinds of programs (especially
those that generate output), but it comes with some caveats.</p>
<a id="md:basics-of-output-testing" class="tsd-anchor"></a><h2><a href="#md:basics-of-output-testing">Basics of Output Testing</a></h2><p>Consider a test program like this:</p>
<pre><code class="language-js"><span class="hl-6">// tagger.mjs</span><br/><span class="hl-2">export</span><span class="hl-1"> </span><span class="hl-2">default</span><span class="hl-1"> (</span><span class="hl-0">tag</span><span class="hl-1">: </span><span class="hl-7">string</span><span class="hl-1">, </span><span class="hl-0">contents</span><span class="hl-1">: </span><span class="hl-7">string</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><br/><span class="hl-1">  </span><span class="hl-3">`&lt;</span><span class="hl-5">${</span><span class="hl-0">tag</span><span class="hl-5">}</span><span class="hl-3">&gt;</span><span class="hl-5">${</span><span class="hl-0">contents</span><span class="hl-5">}</span><span class="hl-3">&lt;/</span><span class="hl-5">${</span><span class="hl-0">tag</span><span class="hl-5">}</span><span class="hl-3">&gt;`</span>
</code><button>Copy</button></pre>
<p>We might have a test like this:</p>
<pre><code class="language-js"><span class="hl-6">// tagger.test.mjs</span><br/><span class="hl-2">import</span><span class="hl-1"> </span><span class="hl-0">t</span><span class="hl-1"> </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&#39;tap&#39;</span><br/><span class="hl-2">import</span><span class="hl-1"> </span><span class="hl-0">tagger</span><span class="hl-1"> </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&#39;./tagger.mjs&#39;</span><br/><span class="hl-0">t</span><span class="hl-1">.</span><span class="hl-4">equal</span><span class="hl-1">(</span><span class="hl-4">tagger</span><span class="hl-1">(</span><span class="hl-3">&#39;tagName&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;content&#39;</span><span class="hl-1">), </span><span class="hl-3">&#39;&lt;tagName&gt;content&lt;/tagName&gt;&#39;</span><span class="hl-1">)</span>
</code><button>Copy</button></pre>
<p>This is good for a couple of reasons:</p>
<ol>
<li>It&#39;s clear reading our test what the expected output is.</li>
<li>We&#39;re unlikely to create a test without thinking carefully about
what <em>exactly</em> it&#39;s testing.</li>
</ol>
<p>However, managing strings like this can become extremely tedious,
especially in cases where the output is long, or there are many cases
to test. If we make an <em>intentional</em> change to the output, then we
need to manually update a large number of large strings, possibly
scattered throughout the test suite. The inevitable result is
that we either make the tests less comprehensive, or even worse,
treat some as <a href="https://node-tap.org/basics/#note-about-%22expected-failures%22-and-%22run-until-good%22-testing">&quot;known
failures&quot;</a>.</p>
<a id="md:testing-output-with-snapshots" class="tsd-anchor"></a><h2><a href="#md:testing-output-with-snapshots">Testing Output with Snapshots</a></h2><p>We could also write our test file like this:</p>
<pre><code class="language-js"><span class="hl-6">// tagger.test.mjs</span><br/><span class="hl-2">import</span><span class="hl-1"> </span><span class="hl-0">t</span><span class="hl-1"> </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&#39;tap&#39;</span><br/><span class="hl-2">import</span><span class="hl-1"> </span><span class="hl-0">tagger</span><span class="hl-1"> </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&#39;./tagger.mjs&#39;</span><br/><span class="hl-0">t</span><span class="hl-1">.</span><span class="hl-4">matchSnapshot</span><span class="hl-1">(</span><span class="hl-4">tagger</span><span class="hl-1">(</span><span class="hl-3">&#39;tagName&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;content&#39;</span><span class="hl-1">), </span><span class="hl-3">&#39;output&#39;</span><span class="hl-1">)</span>
</code><button>Copy</button></pre>
<p>But wait, where is the expected output?</p>
<p>To create the snapshot file, run this command:</p>
<pre><code><span class="hl-0">$</span><span class="hl-1"> </span><span class="hl-0">tap</span><span class="hl-1"> </span><span class="hl-0">tagger</span><span class="hl-1">.</span><span class="hl-0">test</span><span class="hl-1">.</span><span class="hl-0">mjs</span><span class="hl-1"> --</span><span class="hl-0">snapshot</span><br/><span class="hl-1"> </span><span class="hl-9">PASS</span><span class="hl-1">  </span><span class="hl-0">test</span><span class="hl-1">.</span><span class="hl-0">js</span><span class="hl-1"> </span><span class="hl-8">1</span><span class="hl-1"> </span><span class="hl-9">OK</span><span class="hl-1"> 344</span><span class="hl-0">ms</span><br/><br/><br/><span class="hl-1">  ðŸŒˆ </span><span class="hl-9">SUMMARY</span><span class="hl-1"> </span><span class="hl-9">RESULTS</span><span class="hl-1"> ðŸŒˆ</span><br/><br/><br/><span class="hl-17">Suites</span><span class="hl-1">:   </span><span class="hl-8">1</span><span class="hl-1"> </span><span class="hl-0">passed</span><span class="hl-1">, </span><span class="hl-8">1</span><span class="hl-1"> </span><span class="hl-5">of</span><span class="hl-1"> </span><span class="hl-8">1</span><span class="hl-1"> </span><span class="hl-0">completed</span><br/><span class="hl-17">Asserts</span><span class="hl-1">:  </span><span class="hl-8">1</span><span class="hl-1"> </span><span class="hl-0">passed</span><span class="hl-1">, </span><span class="hl-5">of</span><span class="hl-1"> </span><span class="hl-8">1</span><br/><span class="hl-17">Time</span><span class="hl-1">:     422</span><span class="hl-0">ms</span>
</code><button>Copy</button></pre>
<p>By setting <code>TAP_SNAPSHOT</code> in the environment or passing the <code>--snapshot</code>
command line flag, we tell tap to write the output to a special file, and
treat the assertion as automatically passing.</p>
<p>Snapshots will be generated by default if the npm script being run is named
<code>snap</code> or <code>snapshot</code>, so you can use this pattern to test and snapshot most
projects:</p>
<pre><code class="language-json"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-13">&quot;name&quot;</span><span class="hl-1">: </span><span class="hl-3">&quot;my-project&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-13">&quot;version&quot;</span><span class="hl-1">: </span><span class="hl-3">&quot;1.2.3&quot;</span><span class="hl-1">,</span><br/><br/><span class="hl-1">  </span><span class="hl-13">&quot;devDependencies&quot;</span><span class="hl-1">: {</span><br/><span class="hl-1">    </span><span class="hl-13">&quot;tap&quot;</span><span class="hl-1">: </span><span class="hl-3">&quot;15&quot;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-13">&quot;scripts&quot;</span><span class="hl-1">: {</span><br/><span class="hl-1">    </span><span class="hl-13">&quot;test&quot;</span><span class="hl-1">: </span><span class="hl-3">&quot;tap&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-13">&quot;snap&quot;</span><span class="hl-1">: </span><span class="hl-3">&quot;tap&quot;</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>Then, you can use <code>npm test</code> to run your tests, or <code>npm run snap</code> to
update snapshot files.</p>
<a id="md:snapshot-files" class="tsd-anchor"></a><h2><a href="#md:snapshot-files">Snapshot Files</a></h2><p>The generated file is designed to be human-readable, but you
should not edit it directly.</p>
<pre><code><span class="hl-0">$</span><span class="hl-1"> </span><span class="hl-0">cat</span><span class="hl-1"> </span><span class="hl-0">tap</span><span class="hl-1">-</span><span class="hl-0">snapshots</span><span class="hl-1">/</span><span class="hl-0">tagger</span><span class="hl-1">.</span><span class="hl-0">test</span><span class="hl-1">.</span><span class="hl-0">mjs</span><span class="hl-1">.</span><span class="hl-0">test</span><span class="hl-1">.</span><span class="hl-0">cjs</span><br/><span class="hl-6">/* IMPORTANT</span><br/><span class="hl-6"> * This snapshot file is auto-generated, but designed for humans.</span><br/><span class="hl-6"> * It should be checked into source control and tracked carefully.</span><br/><span class="hl-6"> * Re-generate by setting TAP_SNAPSHOT=1 and running tests.</span><br/><span class="hl-6"> * Make sure to inspect the output below.  Do not ignore changes!</span><br/><span class="hl-6"> */</span><br/><span class="hl-3">&#39;use strict&#39;</span><br/><span class="hl-7">exports</span><span class="hl-1">[</span><span class="hl-3">`tagger.test.mjs TAP &gt; output 1`</span><span class="hl-1">] = </span><span class="hl-3">`</span><br/><span class="hl-3">&lt;tagName&gt;content&lt;/tagName&gt;</span>
</code><button>Copy</button></pre>
<p>If the argument passed to <code>t.matchSnapshot()</code> isn&#39;t a string,
then it will be converted to a string using
<a href="https://tapjs.github.io/tapjs/modules/tcompare.html">tcompare.format</a>.
This is typically pretty easy for humans to understand, but of
course if you prefer to use <code>JSON.stringify</code> or something else,
you can do so easily enough. The
<a href="https://tapjs.github.io/tapjs/classes/_tapjs_test.index.Test.html#formatSnapshot">t.formatSnapshot</a>
can be used to customize this for an entire test.</p>
<a id="md:caveats" class="tsd-anchor"></a><h2><a href="#md:caveats">Caveats</a></h2><a id="md:track-changes" class="tsd-anchor"></a><h3><a href="#md:track-changes">Track Changes</a></h3><p><strong>Important: you should check the snapshot file into source control!</strong></p>
<p>When there are changes to it, inspect the diff and make sure that nothing
unexpected happened to change your output.</p>
<p>If you don&#39;t check this file into source control, then a significant part
of your test is not checked in. This prevents people from collaborating on
your project.</p>
<p>If you accept changes to it without care, then you can obscure unintended
changes. (Though, even if this happens, <code>git bisect</code> can track down the
source of the change quite quickly, so it&#39;s not the end of the world if
there are occasional mistakes.)</p>
<a id="md:strip-variables-from-output-with-tcleansnapshot" class="tsd-anchor"></a><h3><a href="#md:strip-variables-from-output-with-tcleansnapshot">Strip Variables from Output with <code>t.cleanSnapshot</code></a></h3><p>If your output includes data that is known to change from one run to the
next, then these changes should be stripped before matching against a
snapshot.</p>
<p>This includes process IDs, time stamps, and many other system details.</p>
<p>Consider this function:</p>
<pre><code class="language-js"><span class="hl-6">// msgtime.mjs</span><br/><span class="hl-2">export</span><span class="hl-1"> </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-4">msgTime</span><span class="hl-1"> = </span><span class="hl-0">msg</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">return</span><span class="hl-1"> </span><span class="hl-0">msg</span><span class="hl-1"> + </span><span class="hl-3">&#39; time=&#39;</span><span class="hl-1"> + </span><span class="hl-0">Date</span><span class="hl-1">.</span><span class="hl-4">now</span><span class="hl-1">()</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>Since the output will obviously be slightly different every time the
function is tested, we need to strip out the time value.</p>
<p>The best way to do this is with a
<a href="https://tapjs.github.io/tapjs/classes/_tapjs_test.index.Test.html#cleanSnapshot"><code>t.cleanSnapshot</code></a>
function. This function takes the formatted snapshot as a string,
and returns a string to be saved or compared against. The default
cleaner is an identity function that returns its input without
any changes.</p>
<p>A test that uses this method:</p>
<pre><code class="language-js"><span class="hl-6">// msgtime.test.mjs</span><br/><span class="hl-2">import</span><span class="hl-1"> </span><span class="hl-0">t</span><span class="hl-1"> </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&#39;tap&#39;</span><br/><br/><span class="hl-6">// This must be assigned *before* running tests</span><br/><span class="hl-6">// It is passed down to child tests when they are created</span><br/><span class="hl-0">t</span><span class="hl-1">.</span><span class="hl-4">cleanSnapshot</span><span class="hl-1"> = </span><span class="hl-0">s</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">s</span><span class="hl-1">.</span><span class="hl-4">replace</span><span class="hl-1">(</span><span class="hl-18">/ time=</span><span class="hl-19">[</span><span class="hl-18">0-9</span><span class="hl-19">]</span><span class="hl-20">+</span><span class="hl-21">$</span><span class="hl-18">/</span><span class="hl-5">g</span><span class="hl-1">, </span><span class="hl-3">&#39; time={time}&#39;</span><span class="hl-1">)</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-9">output</span><span class="hl-1"> = </span><span class="hl-4">msgTime</span><span class="hl-1">(</span><span class="hl-3">&#39;this is a test&#39;</span><span class="hl-1">)</span><br/><span class="hl-0">t</span><span class="hl-1">.</span><span class="hl-4">matchSnapshot</span><span class="hl-1">(</span><span class="hl-0">output</span><span class="hl-1">, </span><span class="hl-3">&#39;add timestamp to message&#39;</span><span class="hl-1">)</span>
</code><button>Copy</button></pre>
<p>When run with <code>--snapshot</code>, it generates this snapshot
file:</p>
<pre><code class="language-js"><span class="hl-6">/* IMPORTANT</span><br/><span class="hl-6"> * This snapshot file is auto-generated, but designed for humans.</span><br/><span class="hl-6"> * It should be checked into source control and tracked carefully.</span><br/><span class="hl-6"> * Re-generate by setting TAP_SNAPSHOT=1 and running tests.</span><br/><span class="hl-6"> * Make sure to inspect the output below.  Do not ignore changes!</span><br/><span class="hl-6"> */</span><br/><span class="hl-3">&#39;use strict&#39;</span><br/><span class="hl-7">exports</span><span class="hl-1">[</span><span class="hl-3">`msgtime.test.js TAP &gt; add timestamp to message 1`</span><span class="hl-1">] = </span><span class="hl-3">`</span><br/><span class="hl-3">this is a test time={time}</span><br/><span class="hl-3">`</span>
</code><button>Copy</button></pre>
<a id="md:custom-formatting" class="tsd-anchor"></a><h2><a href="#md:custom-formatting">Custom Formatting</a></h2><p>Sometimes just modifying the string is not enough, or a special data type
should be stringified differently.</p>
<p>By default, tap uses
<a href="https://tapjs.github.io/tapjs/functions/tcompare.index.format-1.html"><code>tcompare.format</code></a>
to convert all non-string values into strings for saving and
comparing.</p>
<p>To override this and provide your own behavior, set a function to
<a href="https://tapjs.github.io/tapjs/classes/_tapjs_test.index.Test.html#cleanSnapshot"><code>t.formatSnapshot</code></a>.
Like <code>t.cleanSnapshot</code>, child tests will copy their parent test&#39;s
value at their time of creation.</p>
<p>An example of using <code>t.formatSnapshot</code>:</p>
<pre><code class="language-js"><span class="hl-2">import</span><span class="hl-1"> </span><span class="hl-0">t</span><span class="hl-1"> </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&#39;tap&#39;</span><br/><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">stringify</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&#39;tap-yaml&#39;</span><br/><span class="hl-0">t</span><span class="hl-1">.</span><span class="hl-4">formatSnapshot</span><span class="hl-1"> = </span><span class="hl-0">object</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">stringify</span><span class="hl-1">(</span><span class="hl-0">object</span><span class="hl-1">)</span><br/><br/><span class="hl-6">// now all my snapshot files will be in yaml!</span><br/><span class="hl-0">t</span><span class="hl-1">.</span><span class="hl-4">matchSnapshot</span><span class="hl-1">({ </span><span class="hl-0">foo:</span><span class="hl-1"> [</span><span class="hl-3">&#39;bar&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;baz&#39;</span><span class="hl-1">] })</span>
</code><button>Copy</button></pre>
<p>This will produce the following snapshot
file:</p>
<pre><code class="language-js"><span class="hl-6">/* IMPORTANT</span><br/><span class="hl-6"> * This snapshot file is auto-generated, but designed for humans.</span><br/><span class="hl-6"> * It should be checked into source control and tracked carefully.</span><br/><span class="hl-6"> * Re-generate by setting TAP_SNAPSHOT=1 and running tests.</span><br/><span class="hl-6"> * Make sure to inspect the output below.  Do not ignore changes!</span><br/><span class="hl-6"> */</span><br/><span class="hl-3">&#39;use strict&#39;</span><br/><span class="hl-7">exports</span><span class="hl-1">[</span><span class="hl-3">`yaml.test.js TAP &gt; must match snapshot 1`</span><span class="hl-1">] = </span><span class="hl-3">`</span><br/><span class="hl-3">foo:</span><br/><span class="hl-3">  - bar</span><br/><span class="hl-3">  - baz</span><br/><br/><span class="hl-3">`</span>
</code><button>Copy</button></pre>
<a id="md:advanced-customization-warning-footguns" class="tsd-anchor"></a><h2><a href="#md:advanced-customization-warning-footguns">Advanced Customization (Warning: footguns!)</a></h2><p>By default, the snapshot file that TAP uses is set based on the test
filename and any arguments passed to it. This prevents having two test
suites clobber one another&#39;s snapshots.</p>
<p>If you would like to specify a different filename for your snapshots, you
can do so by setting the
<a href="https://tapjs.github.io/tapjs/classes/_tapjs_test.index.Test.html#snapshotFile"><code>t.snapshotFile</code></a>
field. If you set this field in a child test, then the <em>parent</em>
test (and all of its other child tests) will still use its old
snapshot file, but snapshots in the child test (and all its
children) will go to the new file.</p>
<p>But, be advised, this is advanced usage and exposes you to some hazards!</p>
<ul>
<li>When generating snapshots, the file is <em>overwritten</em>, so if two tests use
the same snapshot file, they will <em>not</em> be merged. The last one will win.
Make sure that every snapshot file you use is unique to the entire test
run.</li>
<li>Snapshot files should always be in a folder called <code>tap-snapshot</code>, and
should always end in <code>.test.cjs</code>. This pattern ensures that tap can load
them properly, and that they will not be confused with normal test files.</li>
</ul>
<p>Example of using a separate snapshot file for subtests:</p>
<pre><code class="language-js"><span class="hl-6">// file &#39;test/snappy.js&#39;</span><br/><span class="hl-2">import</span><span class="hl-1"> </span><span class="hl-0">t</span><span class="hl-1"> </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&#39;tap&#39;</span><br/><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">resolve</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&#39;node:path&#39;</span><br/><br/><span class="hl-0">t</span><span class="hl-1">.</span><span class="hl-4">matchSnapshot</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-3">&#39;this writes to ./tap-snapshots/test/snappy.js.test.cjs&#39;</span><br/><span class="hl-1">)</span><br/><br/><span class="hl-0">t</span><span class="hl-1">.</span><span class="hl-4">test</span><span class="hl-1">(</span><span class="hl-3">&#39;foo&#39;</span><span class="hl-1">, </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">t</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">// this writes to ./test/tap-snapshots/foo.test.cjs&#39;</span><br/><span class="hl-1">  </span><span class="hl-6">// either path or file URL or file URL string is fine, but</span><br/><span class="hl-1">  </span><span class="hl-6">// it&#39;ll always store it as the actual path.</span><br/><span class="hl-1">  </span><span class="hl-0">t</span><span class="hl-1">.</span><span class="hl-0">snapshotFile</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-4">URL</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;../tap-snapshots/foo.test.cjs&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">import</span><span class="hl-1">.</span><span class="hl-0">meta</span><span class="hl-1">.</span><span class="hl-0">url</span><br/><span class="hl-1">  )</span><br/><span class="hl-1">  </span><span class="hl-0">t</span><span class="hl-1">.</span><span class="hl-4">matchSnapshot</span><span class="hl-1">(</span><span class="hl-3">&#39;foo&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-0">t</span><span class="hl-1">.</span><span class="hl-4">test</span><span class="hl-1">(</span><span class="hl-3">&#39;bar&#39;</span><span class="hl-1">, </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">t</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">// this writes to ./test/tap-snapshots/bar.test.cjs&#39;</span><br/><span class="hl-1">  </span><span class="hl-0">t</span><span class="hl-1">.</span><span class="hl-0">snapshotFile</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-4">URL</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;../tap-snapshots/bar.test.cjs&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">import</span><span class="hl-1">.</span><span class="hl-0">meta</span><span class="hl-1">.</span><span class="hl-0">url</span><br/><span class="hl-1">  )</span><br/><span class="hl-1">  </span><span class="hl-0">t</span><span class="hl-1">.</span><span class="hl-4">matchSnapshot</span><span class="hl-1">(</span><span class="hl-3">&#39;bar&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-0">t</span><span class="hl-1">.</span><span class="hl-4">test</span><span class="hl-1">(</span><span class="hl-3">&#39;baz&#39;</span><span class="hl-1">, </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">t</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">// this one doesn&#39;t set it, so it uses the parent&#39;s snapshot object,</span><br/><span class="hl-1">  </span><span class="hl-6">// which writes to ./tap-snapshots/test/snappy.js.test.cjs</span><br/><span class="hl-1">  </span><span class="hl-0">t</span><span class="hl-1">.</span><span class="hl-4">matchSnapshot</span><span class="hl-1">(</span><span class="hl-3">&#39;baz&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">})</span>
</code><button>Copy</button></pre>
<a id="md:even-more-advanceder-customization-you39re-on-your-own" class="tsd-anchor"></a><h2><a href="#md:even-more-advanceder-customization-you39re-on-your-own">EVEN MORE Advanceder Customization (you&#39;re on your own!)</a></h2><p>This module works by using a <a href="https://tapjs.github.io/tapjs/classes/_tapjs_snapshot.provider.SnapshotProviderDefault.html">Snapshot
Provider</a>,
which is a class that implements read, save, and snap methods.</p>
<p>You can write your own one of those, and pass the custom class in
the <code>snapshotProvider</code> option to a test.</p>
<p>With this, you can store snapshots anywhere you like, if for some
reason putting them in a js file is not your desire.</p>
</section>
<section class="tsd-panel-group tsd-index-group">
<section class="tsd-panel tsd-index-panel">
<h3 class="tsd-index-heading uppercase">Index</h3>
<section class="tsd-index-section">
<h3 class="tsd-index-heading">Modules</h3>
<div class="tsd-index-list"><a href="_tapjs_snapshot.index.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><g id="icon-4"><rect fill="var(--color-icon-background)" stroke="var(--color-ts-namespace)" stroke-width="1.5" x="1" y="1" width="22" height="22" rx="6"></rect><path d="M9.33 16V7.24H10.77L13.446 14.74C13.43 14.54 13.41 14.296 13.386 14.008C13.37 13.712 13.354 13.404 13.338 13.084C13.33 12.756 13.326 12.448 13.326 12.16V7.24H14.37V16H12.93L10.266 8.5C10.282 8.692 10.298 8.936 10.314 9.232C10.33 9.52 10.342 9.828 10.35 10.156C10.366 10.476 10.374 10.784 10.374 11.08V16H9.33Z" fill="var(--color-text)"></path></g></svg><span>index</span></a>
<a href="_tapjs_snapshot.provider.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>provider</span></a>
<a href="_tapjs_snapshot.require.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>require</span></a>
<a href="_tapjs_snapshot.require_esm.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>require-<wbr/>esm</span></a>
</div></section></section></section></div>
<div class="col-sidebar">
<div class="page-menu">
<div class="tsd-navigation settings">
<details class="tsd-index-accordion"><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)" id="icon-chevronDown"></path></svg>Settings</h3></summary>
<div class="tsd-accordion-details">
<div class="tsd-filter-visibility">
<h4 class="uppercase">Member Visibility</h4><form>
<ul id="tsd-filter-options">
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div>
<div class="tsd-theme-toggle">
<h4 class="uppercase">Theme</h4><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div>
<details open class="tsd-index-accordion tsd-page-navigation"><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="#icon-chevronDown"></use></svg>On This Page</h3></summary>
<div class="tsd-accordion-details">
<ul>
<li>
<ul>
<li><a href="#md:tapjssnapshot"><span>@tapjs/snapshot</span></a></li>
<li>
<ul>
<li><a href="#md:usage"><span>USAGE</span></a></li>
<li><a href="#md:basics-of-output-testing"><span>Basics of <wbr/>Output <wbr/>Testing</span></a></li>
<li><a href="#md:testing-output-with-snapshots"><span>Testing <wbr/>Output with <wbr/>Snapshots</span></a></li>
<li><a href="#md:snapshot-files"><span>Snapshot <wbr/>Files</span></a></li>
<li><a href="#md:caveats"><span>Caveats</span></a></li>
<li>
<ul>
<li><a href="#md:track-changes"><span>Track <wbr/>Changes</span></a></li>
<li><a href="#md:strip-variables-from-output-with-tcleansnapshot"><span>Strip <wbr/>Variables from <wbr/>Output with t.clean<wbr/>Snapshot</span></a></li></ul></li>
<li><a href="#md:custom-formatting"><span>Custom <wbr/>Formatting</span></a></li>
<li><a href="#md:advanced-customization-warning-footguns"><span>Advanced <wbr/>Customization (<wbr/>Warning: footguns!)</span></a></li>
<li><a href="#md:even-more-advanceder-customization-you39re-on-your-own"><span>EVEN MORE <wbr/>Advanceder <wbr/>Customization (you&#39;re on your own!)</span></a></li></ul></li></ul></li></ul></div></details></div>
<div class="site-menu">
<nav class="tsd-navigation"><a href="../index.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>Node TAP</span></a>
<ul class="tsd-small-nested-navigation">
<li><a href="_tapjs_after.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/after -<wbr/> v0.0.0-<wbr/>18</span></a></li>
<li><a href="_tapjs_after_each.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/after-<wbr/>each -<wbr/> v0.0.0-<wbr/>18</span></a></li>
<li><a href="_tapjs_asserts.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/asserts -<wbr/> v0.0.0-<wbr/>18</span></a></li>
<li><a href="_tapjs_before.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/before -<wbr/> v0.0.0-<wbr/>18</span></a></li>
<li><a href="_tapjs_before_each.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/before-<wbr/>each -<wbr/> v0.0.0-<wbr/>18</span></a></li>
<li><a href="_tapjs_clock.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/clock -<wbr/> v0.0.0-<wbr/>8</span></a></li>
<li><a href="_tapjs_config.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/config -<wbr/> v2.0.0-<wbr/>19</span></a></li>
<li><a href="_tapjs_core.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/core -<wbr/> v0.0.0-<wbr/>18</span></a></li>
<li><a href="_tapjs_create_plugin.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/create-<wbr/>plugin -<wbr/> v1.0.3-<wbr/>18</span></a></li>
<li><a href="_tapjs_docs.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/docs</span></a></li>
<li><a href="_tapjs_dummy_plugin.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/dummy-<wbr/>plugin -<wbr/> v0.0.0-<wbr/>18</span></a></li>
<li><a href="_tapjs_esbuild_kit.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/esbuild-<wbr/>kit -<wbr/> v0.0.0-<wbr/>18</span></a></li>
<li><a href="_tapjs_filter.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/filter -<wbr/> v0.0.0-<wbr/>18</span></a></li>
<li><a href="_tapjs_fixture.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/fixture -<wbr/> v0.0.0-<wbr/>18</span></a></li>
<li><a href="_tapjs_intercept.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/intercept -<wbr/> v0.0.0-<wbr/>18</span></a></li>
<li><a href="_tapjs_mock.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/mock -<wbr/> v0.0.0-<wbr/>19</span></a></li>
<li><a href="_tapjs_nock.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/nock -<wbr/> v3.0.0-<wbr/>18</span></a></li>
<li><a href="npm_init_template.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>npm-<wbr/>init-<wbr/>template -<wbr/> v1.0.3-<wbr/>1</span></a></li>
<li><a href="tap_parser.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>tap-<wbr/>parser -<wbr/> v15.0.0-<wbr/>2</span></a></li>
<li><a href="_tapjs_reporter.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/reporter -<wbr/> v0.0.0-<wbr/>20</span></a></li>
<li><a href="_tapjs_run.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/run -<wbr/> v0.0.0-<wbr/>20</span></a></li>
<li><a href="_tapjs_sinon.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/sinon -<wbr/> v0.0.0-<wbr/>18</span></a></li>
<li>
<details class="tsd-index-accordion" open data-key="@tapjs/snapshot"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="#icon-chevronDown"></use></svg><a href="_tapjs_snapshot.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/snapshot -<wbr/> v0.0.0-<wbr/>18</span></a></summary>
<div class="tsd-accordion-details">
<ul class="tsd-nested-navigation">
<li><a href="_tapjs_snapshot.index.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>index</span></a></li>
<li><a href="_tapjs_snapshot.provider.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>provider</span></a></li>
<li><a href="_tapjs_snapshot.require.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>require</span></a></li>
<li><a href="_tapjs_snapshot.require_esm.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>require-<wbr/>esm</span></a></li></ul></div></details></li>
<li><a href="_tapjs_spawn.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/spawn -<wbr/> v0.0.0-<wbr/>18</span></a></li>
<li><a href="_tapjs_stack.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/stack -<wbr/> v0.0.0-<wbr/>6</span></a></li>
<li><a href="_tapjs_stdin.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/stdin -<wbr/> v0.0.0-<wbr/>18</span></a></li>
<li><a href="tap.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>tap -<wbr/> v18.0.0-<wbr/>22</span></a></li>
<li><a href="tcompare.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>tcompare -<wbr/> v6.0.1-<wbr/>4</span></a></li>
<li><a href="_tapjs_test.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/test -<wbr/> v0.0.0-<wbr/>18</span></a></li>
<li><a href="_tapjs_typescript.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/typescript -<wbr/> v0.0.0-<wbr/>18</span></a></li>
<li><a href="_tapjs_worker.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@tapjs/worker -<wbr/> v0.0.0-<wbr/>18</span></a></li>
<li><a href="tap_yaml.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>tap-<wbr/>yaml -<wbr/> v2.1.1-<wbr/>1</span></a></li></ul></nav></div></div></div>
<div class="tsd-generator">
<p>Generated using <a href="https://typedoc.org/" rel="noopener" target="_blank">TypeDoc</a></p></div>
<div class="overlay"></div></body></html>